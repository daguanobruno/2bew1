<%- include('../partials/header', {title}); %>

<div class="row">
    <div class="col-md-6">
        <a class="btn btn-success" href="/audios/create">Novo</a>
    </div>
    <div class="col-md-6">
        <form id="consultar">
            <div class="input-group mb-3">
                <div class="input-group-prepend">
                    <span class="input-group-text" id="basic-addon1">
                        <i data-icon="ei-search"></i>
                    </span>
                </div>
                <input id="query" name="query" class="form-control" value="<%= params.query %>">
            </div>
            <div class="form-group">
                <i class="glyphicon glyphicon-search"></i>
            </div>
        </form>
    </div>
</div>
<div class="row">
    <% if(audios.length > 0) { %>
    <table class="table table-condensed">
        <thead>
            <tr>
                <th>Titulo</th>
                <th>Descrição</th>
                <th>Áudio</th>
            </tr>
        </thead>
        <tbody>

            <% for(var i = 0; i < audios.length; i++) { %>
            <tr>
                <td>
                    <%= audios[i].titulo %>
                </td>
                <td>
                    <%= audios[i].descricao %>
                </td>
                <td>
                    <audio controls>
                        <source src='/uploads/<%= audios[i].path %>' type="audio/mp3">
                    </audio>
                </td>
            </tr>
            <% } %>
        </tbody>
    </table>
    <% } %>

    <% if(audios.length == 0){ %>
    <tr>
        <td colspan="3">Nenhum resultado foi encontrado.</td>
    </tr>
    <% } %>
</div>
<script type="text/javascript">
    document.querySelector("#query").addEventListener('keyup', function (e) {
        if (e.target.value.length == 0) {
            this.removeAttribute('name');
        } else {
            this.setAttribute('name', 'query')
        }
    })
</script>

<%- include('../partials/footer'); %>